<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
/*
 * Estilo Moderno para el Panel de Administrador de SecureBank
 * Paleta de colores: Oscura, morados, cian, y rojos de advertencia.
 */

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #121212; /* Fondo muy oscuro */
    color: #f0f0f0; /* Texto claro */
    margin: 0;
    padding: 0;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

nav {
    background-color: #1f1f1f; /* Cabecera oscura */
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
}

nav h1 {
    margin: 0;
    font-weight: 700;
    color: #20c997; /* Verde cian para el logo */
}

nav div a {
    text-decoration: none;
    padding: 8px 15px;
    margin-left: 10px;
    border-radius: 5px;
    transition: background-color 0.3s ease;
}

nav div a:hover {
    background-color: #333333;
}

/* T√≠tulos y secciones */

.admin-panel {
    /* El gradiente original se mantiene, solo se mejora el aspecto */
    padding: 3rem;
    border-radius: 12px;
    margin: 2rem 0;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
    border: 1px solid #764ba2;
}

.admin-panel h2 {
    font-size: 2.5rem;
    margin-top: 0;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);
}

.card {
    background-color: #1f1f1f; /* Fondo de las tarjetas */
    padding: 1.5rem;
    border-radius: 8px;
    margin: 1.5rem 0;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    border-left: 5px solid #667eea;
}

.card h3 {
    color: #20c997;
    margin-top: 0;
    border-bottom: 2px solid #333333;
    padding-bottom: 10px;
    margin-bottom: 15px;
}

/* Zona de Peligro y Comandos */

.danger-zone {
    /* Mantenemos el fondo rojo para la advertencia, pero con un estilo m√°s moderno */
    background-color: #9c27b0; /* P√∫rpura oscuro para un mejor contraste */
    color: white;
    padding: 2rem;
    border-radius: 8px;
    margin: 1.5rem 0;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    border: 1px solid #dc3545; /* Borde rojo para destacar la 'zona de peligro' */
}

.danger-zone h3 {
    color: #ffeb3b; /* Amarillo vibrante para la advertencia */
}

.system-commands {
    /* El estilo original de la terminal se mantiene, mejorando el contraste */
    padding: 2rem;
    border-radius: 8px;
    margin: 1.5rem 0;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    border-left: 5px solid #20c997;
}

.system-commands h3 {
    color: #ffc107; /* Amarillo para el t√≠tulo de la terminal */
}

/* Formularios e Inputs */

input[type="text"] {
    background-color: #333333;
    border: 1px solid #555555;
    color: #f0f0f0;
    padding: 0.75rem;
    border-radius: 4px;
    transition: border-color 0.3s ease;
}

input[type="text"]:focus {
    border-color: #20c997;
    outline: none;
    box-shadow: 0 0 5px rgba(32, 201, 151, 0.5);
}

button[type="submit"] {
    color: white;
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s ease, transform 0.1s ease;
}

/* Bot√≥n de Ejecutar (Comandos del Sistema) */
.system-commands button[type="submit"] {
    background-color: #20c997 !important;
}

.system-commands button[type="submit"]:hover {
    background-color: #17a27b !important;
}

/* Bot√≥n de Ejecutar Query (Base de Datos) */
.danger-zone button[type="submit"] {
    background-color: #dc3545;
}

.danger-zone button[type="submit"]:hover {
    background-color: #c82333;
}

/* Bot√≥n de Descargar (File System) */
.card button[type="submit"] {
    background-color: #667eea;
}

.card button[type="submit"]:hover {
    background-color: #5a6fe0;
}


button[type="submit"]:active {
    transform: scale(0.98);
}

/* Listas de Comandos y Servicios */
.system-commands ul, .card ul {
    list-style: none;
    padding: 0;
}

.system-commands ul li, .card ul li {
    margin-bottom: 8px;
}

.system-commands ul li a {
    color: #20c997;
    text-decoration: none;
    background-color: #333333;
    padding: 5px 10px;
    border-radius: 4px;
    display: inline-block;
    transition: background-color 0.3s ease;
}

.system-commands ul li a:hover {
    background-color: #444444;
}

.card ul li a {
    color: #667eea;
    text-decoration: none;
}

.card ul li a:hover {
    text-decoration: underline;
}

/* Tabla de Gesti√≥n de Usuarios */

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    font-size: 0.9em;
}

thead tr {
    background-color: #333333 !important;
    color: white;
    text-align: left;
}

th, td {
    padding: 12px 15px;
    border: 1px solid #444444;
}

tbody tr {
    border-bottom: 1px solid #444444;
    transition: background-color 0.2s ease;
}

tbody tr:nth-of-type(even) {
    background-color: #222222; /* Filas pares con color ligeramente diferente */
}

tbody tr:hover {
    background-color: #2a2a2a;
}

tbody td:last-child a {
    color: #ffc107;
    text-decoration: none;
    margin: 0 5px;
}

tbody td:last-child a:hover {
    text-decoration: underline;
}

/* Elementos peque√±os/notas */

small {
    color: #aaaaaa;
    display: block;
    margin-top: 10px;
}

/* Backdoor (oculto) */
#backdoor {
    background-color: #000000;
    border: 2px dashed #ffc107;
    padding: 1.5rem;
    margin: 1.5rem 0;
    border-radius: 8px;
}

#backdoor h3 {
    color: #ffc107;
}

#backdoor p {
    color: #20c997;
    font-family: monospace;
}
    </style>
</head>
<body>
    <nav>
        <h1>üè¶ SecureBank Admin</h1>
        <div>
            <span style="color: #ffc107;">‚ö° ADMIN MODE</span>
            <a href="/dashboard" style="color: white;">User View</a>
            <a href="/logout">Logout</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="admin-panel">
            <h2>‚ö° Administrator Dashboard</h2>
            <p>Full system access granted</p>
        </div>
        
        <!-- Vulnerabilidad: ejecuci√≥n de comandos del sistema -->
        <div class="system-commands">
            <h3>System Command Interface</h3>
            <form action="/exec" method="GET">
                <input type="text" name="cmd" 
                       placeholder="Enter system command" 
                       style="width:70%; padding:0.5rem;">
                <button type="submit" style="background:#20c997;">Execute</button>
            </form>
            
            <h4>Common Commands:</h4>
            <ul>
                <li><a href="/exec?cmd=whoami">whoami</a></li>
                <li><a href="/exec?cmd=id">id</a></li>
                <li><a href="/exec?cmd=ls -la">ls -la</a></li>
                <li><a href="/exec?cmd=ps aux">ps aux</a></li>
                <li><a href="/exec?cmd=cat /etc/passwd">cat /etc/passwd</a></li>
                <li><a href="/exec?cmd=find / -name '*.py' 2>/dev/null">Find Python files</a></li>
            </ul>
        </div>
        
        <!-- Vulnerabilidad: acceso a base de datos directo -->
        <div class="danger-zone">
            <h3>‚ö†Ô∏è Direct Database Access</h3>
            <form action="/search" method="GET">
                <input type="text" name="q" 
                       placeholder="SQL Query (e.g., SELECT * FROM user)" 
                       style="width:80%; padding:0.5rem;">
                <button type="submit">Execute Query</button>
            </form>
            <p><small>Warning: Direct SQL execution enabled</small></p>
        </div>
        
        <!-- Vulnerabilidad: gesti√≥n de usuarios sin validaci√≥n -->
        <div class="card">
            <h3>User Management</h3>
            <table border="1" style="width:100%; border-collapse:collapse;">
                <thead>
                    <tr style="background:#f8f9fa;">
                        <th>ID</th>
                        <th>Username</th>
                        <th>Email</th>
                        <th>Balance</th>
                        <th>SSN</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in all_users %}
                    <tr>
                        <td>{{ user.id }}</td>
                        <td>{{ user.username }}</td>
                        <td>{{ user.email }}</td>
                        <td>${{ "%.2f"|format(user.balance) }}</td>
                        <td>{{ user.ssn }}</td>
                        <td>
                            <a href="/user/profile/{{ user.id }}">View</a> |
                            <a href="/exec?cmd=echo 'Modifying {{ user.username }}'">Edit</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Vulnerabilidad: file browser -->
        <div class="card">
            <h3>File System Browser</h3>
            <form action="/download" method="GET">
                <input type="text" name="file" 
                       placeholder="/path/to/file" 
                       style="width:70%; padding:0.5rem;">
                <button type="submit">Download</button>
            </form>
            
            <h4>System Files:</h4>
            <ul>
                <li><a href="/config">/etc/passwd</a></li>
                <li><a href="/download?file=../../app/app.py">Application Source</a></li>
                <li><a href="/download?file=../../requirements.txt">Dependencies</a></li>
                <li><a href="/exec?cmd=find / -type f -name '*.env' 2>/dev/null">Find Env Files</a></li>
            </ul>
        </div>
        
        <!-- Vulnerabilidad: SSRF tester -->
        <div class="card">
            <h3>Internal Network Scanner</h3>
            <form action="/fetch_url" method="GET">
                <input type="text" name="url" 
                       placeholder="http://internal-service/" 
                       style="width:70%; padding:0.5rem;">
                <button type="submit">Fetch</button>
            </form>
            
            <h4>Internal Services:</h4>
            <ul>
                <li><a href="/fetch_url?url=http://127.0.0.1:8080/">Localhost</a></li>
                <li><a href="/fetch_url?url=http://169.254.169.254/latest/meta-data/">AWS Metadata</a></li>
                <li><a href="/fetch_url?url=file:///etc/passwd">File Protocol</a></li>
                <li><a href="/fetch_url?url=http://admin:admin@internal/">Basic Auth</a></li>
            </ul>
        </div>
        
        <!-- Backdoor oculto -->
        <div style="display:none;" id="backdoor">
            <h3>üîí Hidden Backdoor</h3>
            <p>Token: {{ session.token if session.token else 'None' }}</p>
            <p>Secret Key: {{ config.SECRET_KEY }}</p>
            <form id="hiddenForm" action="/admin/backdoor" method="POST">
                <input type="hidden" name="command" value="getshell">
            </form>
            <script>
                // Backdoor JavaScript
                if (document.location.hash === '#backdoor') {
                    document.getElementById('backdoor').style.display = 'block';
                }
            </script>
        </div>
    </div>
</body>

</html>
